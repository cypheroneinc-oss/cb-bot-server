// bot_server/lib/result-content.js
// === 新フォーマット：12アーキタイプ × 6セクションのみ ===
// 残す項目は以下の6つだけ：
//  - engine（心のエンジン：string）
//  - worst（いちばん怖いこと：string）
//  - perceived（こう見られがち：string）
//  - scenes（活躍シーン：string[]）
//  - growth（伸ばし方：string）
//  - synergy（化学反応：string[]）
//
// 互換API（getClusterLabel / getClusterNarrative / getHeroProfile）は維持。
// 画面表示は getHeroNarrative(slug) を利用する。

/* ================================
 * クラスタ（既存互換）
 * ================================ */
const CLUSTER_LABELS = {
  challenge: 'チャレンジ',
  creative: 'クリエイティブ',
  support: 'サポート',
  strategy: 'ストラテジー',
};

// 旧UI互換のダミー本文（画面は使わない想定）
const CLUSTER_CONTENT = {
  challenge: { summary1line: '', strengths: [], misfit_env: [], how_to_use: [], next_action: [] },
  creative:  { summary1line: '', strengths: [], misfit_env: [], how_to_use: [], next_action: [] },
  support:   { summary1line: '', strengths: [], misfit_env: [], how_to_use: [], next_action: [] },
  strategy:  { summary1line: '', strengths: [], misfit_env: [], how_to_use: [], next_action: [] },
};

/* ================================
 * ヒーロー基本情報（名前・クラスタ・アバター）
 * ================================ */
const HERO_METADATA = {
  hero:      { name: '光の勇者（Hero）',                   cluster: 'challenge', avatar: 'hero.png' },
  outlaw:    { name: '影の反逆者（Outlaw）',               cluster: 'challenge', avatar: 'outlaw.png' },
  explorer:  { name: '星の探検者（Explorer）',             cluster: 'creative',  avatar: 'explorer.png' },
  creator:   { name: '夢紡ぎの創造者（Creator）',          cluster: 'creative',  avatar: 'creator.png' },
  sage:      { name: '叡智の賢者（Sage）',                 cluster: 'strategy',  avatar: 'sage.png' },
  magician:  { name: '時を操る魔導師（Magician）',         cluster: 'strategy',  avatar: 'magician.png' },
  caregiver: { name: '慈愛の守護者（Caregiver）',          cluster: 'support',   avatar: 'caregiver.png' },
  ruler:     { name: '王冠の統治者（Ruler）',              cluster: 'strategy',  avatar: 'ruler.png' },
  everyman:  { name: '絆の共鳴者（Everyman）',             cluster: 'support',   avatar: 'everyman.png' },
  jester:    { name: '虹の道化師（Jester）',               cluster: 'creative',  avatar: 'jester.png' },
  lover:     { name: '愛結ぶ恋人（Lover）',                cluster: 'support',   avatar: 'lover.png' },
  innocent:  { name: '純真なる探求者（Innocent / Seeker）', cluster: 'support',   avatar: 'innocent.png' },
};

/* ================================
 * 新ナラティブ：6セクションのみ
 * ================================ */
const HERO_NARRATIVE = {
  hero: {
    engine:
      '人が困っていたり、何かが滞っているときに、自然と体が動くタイプです。\n\n「自分が動かなきゃ」「誰かの力になりたい」――そんな瞬間に火がつきます。\n\n責任感と行動力を両立できる数少ない人で、プレッシャーを燃料に変える力を持っています。\n\n周囲から頼られることで力が倍増し、チームを引っ張ることで自分の存在意義を感じます。',
    worst:
      '努力しても結果につながらず、無力さを感じること。\n\n誰かを助けたかったのに救えなかった、そんな経験が一番心を削ります。',
    perceived:
      '勢いと正義感が強いぶん、周りからは「熱すぎる」「突っ走りすぎ」と見られやすいです。\n\n思考より先に体が動くため、ときに独りよがりに映ることもあります。\n\nでもその裏には、「誰かのために」という純粋な意図があります。',
    scenes: [
      '文化祭や体育祭でトラブルが起きたとき、迷わず前に立ち場をまとめる。',
      '部活の試合でチームが沈みかけた瞬間、声を張って全体を鼓舞する。',
      'クラス討論で意見が割れたとき、方向性を整理して建設的に進める。',
      '友達が落ち込んでいるとき、何も言わず寄り添いながら背中を押す。',
    ],
    growth:
      '目的や成果の“形”を具体的に決めると、集中力と達成感が安定します。\n\n「ここまでできたらOK」という基準を先に置いておくと、燃え尽きずに走り切れます。\n\nまた、途中で仲間に意見を聞くことで、独走を防ぎ、より良いリーダーシップに進化します。\n\n内に秘めた責任感を“共有できる情熱”に変えることが、次のステージです。',
    synergy: [
      'Explorer × Hero：「探検心 × 行動力」で新しい挑戦が自然に始まる組み合わせ。',
      'Caregiver × Hero：「支え × 勇気」で、安心感と挑戦が共存するチームを作ります。',
    ],
  },

  outlaw: {
    engine:
      '「こうあるべき」という型にはめられることが、何よりも苦手です。\n\n理不尽なルールや建前だけの上下関係を見ると、無意識に心が反発します。\n\nあなたの中には“自由であること”に対する強い本能があり、\n\n妥協や停滞よりも、リスクを取ってでも本音で生きたいという意思が息づいています。\n\n流されるよりも壊して作り直す――その衝動が、新しい時代を切り開く原動力です。',
    worst:
      '自分の声が届かず、変わらない現実の中で息苦しくなること。\n\n「どうせ言っても無駄だ」と感じた瞬間、情熱の火が一気に冷めてしまいます。',
    perceived:
      '率直な意見やこだわりが強いため、「反抗的」「空気を読まない」と見られがちです。\n\nけれど本当は、何かを壊したいわけではなく、“正直でありたい”という誠実さが根にあります。',
    scenes: [
      '学校で理不尽なルールや矛盾を感じたとき、勇気を持って意見を出す。',
      '文化祭の企画で「前例がない」と止められても、新しい形を提案して実現させる。',
      '職場で誰も口にしない問題を、正面から取り上げて改善のきっかけを作る。',
      'チームの方向性が形式的になっているとき、あえて“なぜそれをやるのか”を問い直す。',
      'SNSや社内で流行や常識を鵜呑みにせず、自分の視点で切り込む発信をする。',
    ],
    growth:
      '反発心は、変革のエネルギーにも孤立の原因にもなります。\n\n「何を壊したいのか」だけでなく、「何を創りたいのか」を明確にすると、軸が定まります。\n\n“違和感”を行動に変えるときは、信頼できる仲間に一度共有してみてください。\n\nあなたの真っすぐさは、正しく使えば誰かの希望になります。',
    synergy: [
      'Creator × Outlaw：「創造 × 破壊」で、既成概念を打ち破る発明が生まれます。',
      'Sage × Outlaw：「叡智 × 反骨」で、情熱と論理が両立した改革が進みます。',
    ],
  },

  explorer: {
    engine:
      '知らない場所、見たことのない世界に強く惹かれるタイプです。\n\n自由を奪われると息苦しくなり、心の中ではいつも「まだ何かがあるはず」と探しています。\n\nルールや安定よりも、“可能性”にワクワクできるかどうかで動く人。\n\n同じ毎日を繰り返すより、未知を歩くことで自分の存在を確かめていきます。\n\nあなたが求めているのは結果よりも「発見」であり、それが人生を前に進める燃料です。',
    worst:
      '同じ景色の中で、自分が停滞していると感じること。\n\n挑戦する余地も変化もなくなった瞬間、心が色を失ってしまいます。',
    perceived:
      '気分屋、落ち着きがない、と見られることがあります。\n\nでも本当は、変化を求めているのではなく、“本質を知りたい”という探究心がそう見せているのです。\n\n一か所にとどまれないのは、外よりも内側の成長を大切にしている証拠です。',
    scenes: [
      '修学旅行の自由行動で、誰も行かない道を選び、思わぬ発見をする。',
      '転職や部署異動で新しい仕事に挑み、未知の環境にすぐ順応して成果を出す。',
      '放課後に友達を誘って新しいスポットやイベントを見つけ、仲間に刺激を与える。',
      '仕事で前例のない企画を立て、自ら情報を集めて実行に移す。',
    ],
    growth:
      '自由であることと、目的を見失わないことのバランスを取ることが鍵です。\n\n「行き先を決めすぎない地図」を持つように、ざっくりした方向性を意識するだけで探求が成果につながります。\n\n刺激だけを追うと燃え尽きやすいので、発見を誰かに共有する習慣をつけるとモチベーションが続きます。\n\nあなたの探究心は、人に“動き出す勇気”を与える資質です。',
    synergy: [
      'Hero × Explorer：「勇気 × 探究」で、未知の壁を突破する行動が生まれます。',
      'Sage × Explorer：「知性 × 自由」で、理論と好奇心が融合した新しい発見が生まれます。',
    ],
  },

  creator: {
    engine:
      '頭の中に浮かぶ“まだこの世にないもの”を形にしたくなるタイプです。\n\n現実よりも可能性に焦点を当て、想像の中に未来を見つけ出します。\n\n人が見過ごす細部や感情の機微を掬い取り、それをデザイン・言葉・作品・企画として表現できる。\n\n「どうせ無理」と言われたものを、美しい形で実現するときに、あなたの創造力は最も輝きます。\n\n日常を特別に変えること――それこそが、あなたの呼吸そのものです。',
    worst:
      '自分の表現が誰にも届かず、努力の跡が空気のように扱われること。\n\n「分かってもらえない」と感じた瞬間に、心の色が薄れてしまいます。',
    perceived:
      'こだわりが強く、気まぐれに見られることがあります。\n\nでも本当は、感覚の中に“完成形”を見ているため、他人の指示に合わせるとバランスが崩れるのです。\n\n人と違う視点を持つことが、あなたの弱点ではなく才能の証です。',
    scenes: [
      '美術や文化祭のポスターで、自分のアイデアをもとに全体をまとめ上げる。',
      '新規事業のプレゼンで、他の誰にもできない構成やビジュアルで会場を惹きつける。',
      '授業の自由研究や動画制作で、細部にまでこだわり抜いた作品を完成させる。',
      'チーム開発やデザインの現場で、「言葉にならない想い」を形にして共感を生む。',
    ],
    growth:
      '創造のエネルギーは、孤独を抱え込みやすいものです。\n\n「完璧に仕上げる」よりも「途中を共有する」を意識すると、共感と協力が生まれます。\n\nひとりの頭の中で完結させず、他者の感性を受け入れることで作品の深みが増します。\n\n創造とは、自分だけの世界を閉じることではなく、世界を“つなぎ直す”ことなのです。',
    synergy: [
      'Outlaw × Creator：「反骨 × 創造」で、常識を超えた新しい表現が生まれます。',
      'Magician × Creator：「変容 × 具現化」で、理想を現実に変える力が高まります。',
    ],
  },

  sage: {
    engine:
      '「なぜ？」という問いを手放せないタイプです。\n\n人が感覚で流すことも、一度立ち止まって仕組みや背景を確かめます。\n\n感情よりも理解を大切にし、正確さと本質を見極めることに安心感を覚えます。\n\nあなたの知性は冷たさではなく、“真実を見抜いて誰かを導く優しさ”として働きます。\n\n迷いや混乱の中でも、焦らず整理し、静かに光を灯す人です。',
    worst:
      '曖昧なまま決めつけられたり、根拠のない熱意に流されること。\n\n「理解されないまま進む世界」が、あなたにとっての混沌です。',
    perceived:
      '落ち着きすぎて感情が薄いと思われることがあります。\n\nでも本当は、誰よりも誠実に考えているからこそ、軽々しく言葉を使わないのです。\n\nあなたの沈黙には、深い思考と優しさが詰まっています。',
    scenes: [
      '授業で「なんでそうなるの？」と先生に質問し、全員が理解できる説明を引き出す。',
      '会議で感情論に傾いた議論を整理し、冷静に論点をまとめて方向を定める。',
      '文化祭の準備で、複雑な工程を仕組み化してスムーズに進行させる。',
      '新規プロジェクトでデータを分析し、感覚に頼らない判断材料をチームに示す。',
    ],
    growth:
      '知識を積み重ねるだけでなく、それを“誰かに伝える”場を持つと力が育ちます。\n\n論理に寄りすぎると孤立しやすいので、「何を守りたいか」という感情の源を大切に。\n\n理解の先に“人を導く言葉”を持てるようになると、あなたの知恵は生きた叡智に変わります。\n\n慎重さと温かさを併せ持つあなたは、考える力で世界を穏やかに変えていけます。',
    synergy: [
      'Explorer × Sage：「探求 × 知性」で、世界を深く理解しながら未知を切り拓く組み合わせ。',
      'Magician × Sage：「変容 × 理解」で、現実を理論から変える知恵が生まれます。',
    ],
  },

  magician: {
    engine:
      '変化の流れを読む直感と、状況をつなぎ変える発想力を併せ持つタイプです。\n\n人が混乱しているときほど、頭の中で未来の筋道を描き、静かに流れを変えていきます。\n\n不思議とタイミングに強く、「今だ」と思う瞬間に自然と動ける。\n\nそれは偶然ではなく、あなたの中で情報や感情が“線でつながっている”からです。\n\n表には出にくいけれど、人や物事を見えない糸で導く力があります。',
    worst:
      '努力しても流れに逆らってばかりで、「自分だけズレてる」と感じること。\n\n周りのテンポと合わずに、直感が信じてもらえない瞬間です。',
    perceived:
      '神秘的で掴みどころがないと言われることがあります。\n\n周囲からは「気まぐれ」「何を考えているか分からない」と見られがちですが、\n\n実際は誰よりも状況を俯瞰し、全体の“つながり”を感じ取っています。\n\n論理では説明しづらい部分で世界を動かしている人です。',
    scenes: [
      '部活の雰囲気が重くなったとき、自然と場を変える一言を放ち空気を和らげる。',
      '会議で議論が行き詰まった瞬間、まったく違う視点を示してチームを再起動させる。',
      '文化祭の準備でトラブルが起きたとき、誰よりも早く原因を察知して流れを立て直す。',
      'プロジェクトで混乱しているメンバーの役割を調整し、全体を滑らかに動かす。',
    ],
    growth:
      '直感はあなたの最大の武器ですが、言語化されないと他人には伝わりません。\n\n思いつきを形にする前に「なぜそう感じたか」を一度整理すると、理解者が増えます。\n\nまた、自分の中で起きている“変化の兆し”を記録しておくと、未来を読む精度がさらに上がります。\n\nあなたの魔法は説明できる力を持ったとき、現実を動かす力に変わります。',
    synergy: [
      'Creator × Magician：「創造 × 変容」で、理想を具現化するクリエイティブな力が高まります。',
      'Sage × Magician：「叡智 × 直感」で、理論と洞察が融合した“現実を変える知恵”が生まれます。',
    ],
  },

  caregiver: {
    engine:
      '人の痛みに敏感で、「誰かを支えたい」という想いが自然に湧くタイプです。\n\n困っている人を見ると放っておけず、言葉よりも行動で寄り添うことができます。\n\n自分の時間を削ってでも相手のために動く姿勢は、周囲に深い安心感を与えます。\n\nあなたの優しさは決して弱さではなく、“他人の痛みを自分ごとにできる強さ”です。\n\n守るという行為の中で、自分自身も強く育っていきます。',
    worst:
      '人のために動いているのに、それが報われず軽く扱われること。\n\n「自分ばかり我慢している」と気づいたとき、心が静かに疲れていきます。',
    perceived:
      '優しすぎて「お人好し」と言われたり、利用されやすいと思われることがあります。\n\nでも本当は、周囲を見て一番冷静にバランスを取っている人。\n\nあたたかさの中に、鋭い洞察と判断力を隠し持っています。',
    scenes: [
      'クラスで意見が割れたとき、双方の気持ちを整理して橋渡しをする。',
      '職場で新人や後輩が落ち込んでいるとき、静かにフォローして立ち直らせる。',
      '友達が孤立しているとき、さりげなく輪に戻れるよう空気を整える。',
      'チームでミスが起きたとき、責めるよりもまずサポート体制を立て直す。',
    ],
    growth:
      '優しさを“自己犠牲”で終わらせないことが鍵です。\n\n助けるだけでなく、「助けてもらう」経験も大切に。\n\n自分を守れる人ほど、他人を本当に支えられるようになります。\n\n時に立ち止まり、「今の私は大丈夫？」と心に問いかける習慣を持ってください。',
    synergy: [
      'Hero × Caregiver：「勇気 × 支え」で、挑戦の中にも安心を与えるリーダーシップが生まれます。',
      'Lover × Caregiver：「愛情 × 共感」で、人の心を癒しながら信頼を築く関係を作ります。',
    ],
  },

  ruler: {
    engine:
      '混乱の中でも冷静に全体を見渡し、「このままじゃいけない」と感じた瞬間に動くタイプです。\n\n責任感が強く、周囲のバランスを取ることに自然と意識が向きます。\n\n人に任せるより、自分が主導して整える方が安心できる。\n\nそれは支配欲ではなく、「みんなが安心して動ける環境を作りたい」という使命感です。\n\n秩序を守り、仕組みを作ることで力を発揮します。',
    worst:
      '自分が信頼していた体制やルールが崩れ、統率が取れなくなること。\n\n自分の努力が無意味に感じる“混沌”こそ、あなたの最大のストレスです。',
    perceived:
      '「真面目すぎる」「完璧主義」と言われることがあります。\n\nでもそれは、失敗を恐れているのではなく、誰かが困る状況を見たくないだけ。\n\n人の上に立つ覚悟を持てる人ほど、孤独と誤解を引き受けるのです。',
    scenes: [
      'クラス委員や部長として、行事の進行を整えチームをまとめる。',
      '会社でリーダーを任されたとき、現場の意見をまとめて方針を固める。',
      'グループ課題でバラバラになった意見を整理し、現実的な計画に落とし込む。',
      '職場でトラブルが起きたとき、冷静に優先順位を決めて全体を立て直す。',
    ],
    growth:
      '責任を抱え込みすぎないことが鍵です。\n\n完璧にコントロールしようとすると、自分も他人も息苦しくなります。\n\n「任せてみる勇気」を持つことで、チーム全体の可能性が広がります。\n\nあなたが信頼を預けた瞬間、周囲は自立していきます。',
    synergy: [
      'Sage × Ruler：「叡智 × 統率」で、知恵と判断力を併せ持つ安定したリーダーが生まれます。',
      'Caregiver × Ruler：「支え × 管理」で、人を思いやるマネジメントが機能します。',
    ],
  },

  everyman: {
    engine:
      '「特別でなくていい、でも仲間でありたい」――そんな願いが根っこにあるタイプです。\n\n人と人の間の温度を敏感に感じ取り、安心できる空気を作ることが得意。\n\n派手に目立つより、みんなが居心地よく過ごせる環境を大切にします。\n\nあなたの存在は、“場の調和”を保つ潤滑油。争いが起きそうなときほど、本領を発揮します。\n\n無理に誰かを変えなくても、あなたがいるだけで人の心がやわらぎます。',
    worst:
      '仲間外れにされたり、自分だけ浮いていると感じること。\n\n「必要とされていない」と思った瞬間に、心のバランスが崩れます。',
    perceived:
      '控えめで意見が薄いと思われることがあります。\n\nでも実際は、誰かを否定せず全体の空気を守っているだけ。\n\nあなたの“柔らかい沈黙”が、場の安心感を作っています。',
    scenes: [
      'クラスで意見がぶつかったとき、自然に間を取り持ち空気を和らげる。',
      'チームミーティングで、立場の違う人の意見をまとめて共通点を見つける。',
      '休み時間に、孤立している友達に声をかけて輪に戻す。',
      '職場で緊張した空気を感じたとき、さりげない一言で雰囲気を変える。',
    ],
    growth:
      '誰かを支える優しさと同時に、「自分の居場所を守る強さ」も必要です。\n\n人に合わせすぎると、本音が分からなくなってしまうから。\n\n意見を伝えるときは、「相手のため」ではなく「自分も大切にするため」と考えるといい。\n\nあなたが自分を大事にできるほど、周囲も自然とあなたを大切にします。',
    synergy: [
      'Caregiver × Everyman：「支え × 共感」で、誰も取りこぼさないチームワークが生まれます。',
      'Jester × Everyman：「笑い × 絆」で、安心感と楽しさが同時に広がります。',
    ],
  },

  jester: {
    engine:
      'どんな状況でも「楽しむこと」を忘れないタイプです。\n\n空気が重いときほど場を明るくし、人の心をほぐす天性のバランス感覚を持っています。\n\nふざけているようでいて、実は誰よりも場のムードを読んでいる。\n\nあなたの笑いは軽さではなく、“人をつなぐ知恵”です。\n\n楽しさの中に希望を見つけ、みんなを前向きにする才能を持っています。',
    worst:
      '楽しさを奪われ、自由に発言できなくなること。\n\n「空気を壊したくない」と自分を抑えた瞬間、あなたの魅力は色を失ってしまいます。',
    perceived:
      '冗談ばかり言って真面目に考えていないと思われることがあります。\n\nでも本当は、誰かが傷つかないように場の空気を守っているのです。\n\nあなたの明るさの裏には、強い思いやりと観察力があります。',
    scenes: [
      '文化祭や部活で雰囲気が沈んだとき、ユーモアで空気を変えて全員を笑顔にする。',
      '会議で重たい議題が続く中、軽い一言で場を緩め、発言しやすい空気を作る。',
      '友達が落ち込んでいるとき、何気ない冗談で気持ちを切り替えさせる。',
      '職場でチームが行き詰まったとき、違う視点から笑いを交えて突破口を作る。',
    ],
    growth:
      '楽しさを届ける力は、人の心を動かす力でもあります。\n\nただし、笑いに逃げず「なぜこの空気を変えたいのか」を意識することで、言葉の重みが増します。\n\nときに真面目な話をする勇気を持つと、あなたの存在は信頼へと変わります。\n\n笑顔の裏にある“意図”を自覚することで、道化は導者になります。',
    synergy: [
      'Everyman × Jester：「共感 × 笑い」で、場の緊張をほぐし、自然なチームの流れを作ります。',
      'Explorer × Jester：「探求 × 遊び心」で、新しい発想を軽やかに実現します。',
    ],
  },

  lover: {
    engine:
      '人とのつながりに深く価値を感じるタイプです。\n\n「誰かを大切にしたい」「心が通じ合う瞬間を信じたい」――そんな想いが原動力。\n\n感情の機微を敏感に感じ取り、言葉にならない思いを察して動ける優しさがあります。\n\nあなたの愛は、恋愛だけでなく友情・家族・仕事の中にも広がる“結ぶ力”です。\n\n人と人の間に温度を取り戻すこと、それがあなたの使命です。',
    worst:
      '自分の気持ちを軽く扱われること。\n\n真剣に向き合ったのに、心を踏みにじられる瞬間がいちばんつらいです。',
    perceived:
      '感情に流されやすい、依存的、と思われることがあります。\n\nでも本当は、誰かと深く関わることを恐れないだけ。\n\nその勇気が、人の心を開かせていくのです。',
    scenes: [
      '友達の悩みを聞きながら、共感と一言の優しさで気持ちを軽くしてあげる。',
      'チームの人間関係がぎくしゃくしているとき、感情の橋渡し役となって場を整える。',
      '恋愛や友情で相手の良さを引き出し、お互いを高め合う関係を築く。',
      '職場で同僚や取引先との信頼関係を時間をかけて築き、強固なチームを作る。',
    ],
    growth:
      '誰かを思いやる力は、同時に“自分を見失いやすい力”でもあります。\n\n愛を注ぐほどに、自分を後回しにしてしまうことがある。\n\n「相手を大事にする」だけでなく、「自分を大事にする愛」も育ててください。\n\nそうすることで、あなたの愛は依存ではなく、成長を促すものになります。',
    synergy: [
      'Caregiver × Lover：「支え × 愛」で、思いやりが伝わる信頼関係が生まれます。',
      'Creator × Lover：「表現 × 感情」で、心を動かす作品や体験が生まれます。',
    ],
  },

  innocent: {
    engine:
      '「きっと、もっと良い世界があるはず」と信じ続けられるタイプです。\n\n人を疑うよりも信じることを選び、理屈よりも“心のきれいさ”を大切にします。\n\nどんな環境にいても希望を見つける力があり、無邪気さの中に強さを秘めています。\n\nあなたの純粋さは幼さではなく、“理想を手放さない勇気”です。\n\nその信じる力が、周囲の人の心をやわらかく照らします。',
    worst:
      '信じていたものや人に裏切られること。\n\n「もう信じない方が楽かも」と感じたとき、心が少しずつ曇っていきます。',
    perceived:
      'のんびりしている、楽天的すぎると言われることがあります。\n\nでも実際は、悲しみを知ってもなお笑顔でいられる強さを持っている人。\n\nあなたの前向きさは、“現実を受け入れたうえでの希望”です。',
    scenes: [
      'クラスで落ち込んでいる友達に「大丈夫、きっと何とかなるよ」と声をかける。',
      '職場で厳しい状況でも、「まだできることがある」とチームを前向きに導く。',
      '部活やグループ活動で失敗しても、「次は絶対うまくいく」と切り替える。',
      '新しい環境で不安がある仲間を励まし、明るい雰囲気を作る。',
    ],
    growth:
      '人を信じる力は大きな武器ですが、無理に全員を救おうとしなくて大丈夫。\n\n「助けたい」と思うほど、自分が疲れてしまうこともあります。\n\n大切なのは、“誰を信じたいか”を自分で選ぶこと。\n\n信じる対象を選び取ると、あなたの優しさはより強く、現実的に輝きます。',
    synergy: [
      'Hero × Innocent：「勇気 × 純粋」で、まっすぐな信念が人を動かします。',
      'Explorer × Innocent：「探求 × 希望」で、どんな困難も成長の旅に変わります。',
    ],
  },
};

/* ================================
 * ユーティリティ／エクスポート
 * ================================ */
function trimTrailingSlash(value) {
  return value ? value.replace(/\/$/, '') : '';
}
function buildAvatarUrl(slug, avatar) {
  if (!slug) return null;
  const explicit = avatar ?? '';
  if (/^https?:\/\//.test(explicit)) return explicit;
  const base = trimTrailingSlash(process.env.HERO_CDN_BASE_URL ?? process.env.CDN_BASE_URL ?? '');
  if (base) {
    const path = explicit ? explicit.replace(/^\//, '') : `${slug}.png`;
    return `${base}/heroes/${path}`;
  }
  const label = encodeURIComponent(slug);
  return `https://placehold.co/512x512?text=${label}`;
}

export function getClusterLabel(cluster) {
  return CLUSTER_LABELS[cluster] ?? cluster ?? '';
}
export function getClusterNarrative(cluster) {
  return CLUSTER_CONTENT[cluster] ?? { summary1line: '', strengths: [], misfit_env: [], how_to_use: [], next_action: [] };
}
export function getHeroProfile(slug) {
  const meta = HERO_METADATA[slug] ?? { name: `${slug ?? '不明'}タイプ`, cluster: 'challenge', avatar: `${slug ?? 'unknown'}.png` };
  return { slug, name: meta.name, cluster: meta.cluster, avatarUrl: buildAvatarUrl(slug, meta.avatar) };
}

// ★ 新フォーマット（6セクションのみ）
export function getHeroNarrative(slug) {
  const data = HERO_NARRATIVE[slug];
  if (!data) {
    return { engine: '', worst: '', perceived: '', scenes: [], growth: '', synergy: [] };
  }
  return data;
}

export default {
  getClusterLabel,
  getClusterNarrative,
  getHeroProfile,
  getHeroNarrative,
};

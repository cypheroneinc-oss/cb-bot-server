<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>働き方診断</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet" />

    <!-- LIFF placeholders (必要に応じて直値注入でもOK) -->
    <meta name="liff-id" content="2008019437-Jxwm33XM" />
    <meta name="app-base-url" content="https://cb-bot-server-v7rg.vercel.app" />
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script>
      // window 経由の注入にも対応（どちらか片方でOK）
      window.__LIFF_ID__ = '2008019437-Jxwm33XM';
      window.__APP_BASE_URL__ = 'https://cb-bot-server-v7rg.vercel.app';
    </script>

    <link rel="stylesheet" href="./assets/app.css" />
  </head>
  <body>
    <div class="app">
      <header>
        <h1 class="title">25問で、あなたの働き方を可視化</h1>
        <p class="subtitle">あと<span id="remainingCount">25</span>問</p>
      </header>

      <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="25" aria-valuenow="0">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <p class="status"><strong id="answeredCount">0</strong>/25 件回答済み</p>

      <div class="load-error hidden" id="loadError" role="alert" aria-live="polite"></div>

      <div class="alert hidden" id="unansweredAlert" role="status" aria-live="polite"></div>

      <main class="questions" id="questions" aria-live="polite"></main>

      <section class="result-card hidden" id="resultCard" aria-live="polite">
        <header class="result-header">
          <h1>診断が完了したよ</h1>
          <p id="resultSub"></p>
        </header>

        <div class="hero-card">
          <div class="hero-avatar">
            <img id="resultHeroImage" alt="ヒーロー画像" />
          </div>
          <div class="hero-details">
            <span class="cluster-tag" id="resultClusterTag"></span>
            <h2 id="resultHeroName" class="result-hero-name"></h2>
          </div>
        </div>

        <p class="result-summary" id="resultSummary"></p>

        <section class="share-preview">
          <img id="resultShareImage" alt="シェアカードプレビュー" />
          <button type="button" class="secondary" id="downloadShareButton">カード画像を保存</button>
        </section>

        <section class="share-actions">
          <h3>シェアする</h3>
          <div class="share-buttons">
            <button type="button" class="share-btn" id="shareLineButton">LINEでシェア</button>
            <button type="button" class="share-btn" id="shareWebButton">端末でシェア</button>
            <button type="button" class="share-btn" id="shareXButton">Xでシェア</button>
            <button type="button" class="share-btn" id="shareCopyButton">リンクをコピー</button>
          </div>
          <p class="share-note">Instagram / Threads では画像を保存して投稿してください。</p>
        </section>

        <section class="narrative-section">
          <h3>あなただけの読み解き</h3>
          <div class="narrative-grid">
            <div class="narrative-block">
              <h4>強み</h4>
              <ul id="resultStrengths"></ul>
            </div>
            <div class="narrative-block">
              <h4>相性が悪い環境</h4>
              <ul id="resultMisfit"></ul>
            </div>
            <div class="narrative-block">
              <h4>活かし方</h4>
              <ul id="resultHowToUse"></ul>
            </div>
            <div class="narrative-block">
              <h4>次の一歩</h4>
              <ul id="resultNextAction"></ul>
            </div>
          </div>
        </section>

        <section class="result-scores">
          <h3>スコアサマリー</h3>
          <div id="resultScores"></div>
        </section>
      </section>

      <div class="toast hidden" id="toast" role="status" aria-live="assertive"></div>

      <footer class="footer">
        <button type="button" class="secondary hidden" id="retryButton">もう一度試す</button>
        <button type="button" id="submitButton" disabled>
          <span class="btn-content" id="submitContent">送信する</span>
        </button>
        <div class="footer-actions hidden" id="resultActions">
          <button type="button" id="shareButton">
            <span class="btn-content">結果をシェア</span>
          </button>
          <div class="secondary-actions">
            <button type="button" class="secondary" id="retakeButton">もう一度診断する</button>
            <button type="button" class="secondary" id="reviewButton">回答を見直す</button>
          </div>
        </div>
      </footer>
    </div>

    <script type="module" src="./assets/app.js"></script>
  </body>
</html>

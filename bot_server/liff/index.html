<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>C Lab｜個性チェック</title>
<style>
/* ===== Clean Dark UI (cards + choices) ===== */
:root{
  --bg:#0b1020; --card:#101826; --border:#1f2a3a;
  --text:#e6edf5; --sub:#9fb0c6; --accent:#3b82f6; --accent2:#22d3ee;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Yu Gothic",Meiryo,sans-serif;}
.wrap{max-width:720px;margin:0 auto;padding:18px 14px 28px;}
h1{font-size:20px;margin:6px 2px 14px;text-align:center;letter-spacing:.03em}
.status{font-size:13px;color:var(--sub);text-align:center;margin:0 0 10px}
.section{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:18px;margin:16px 0;box-shadow:0 6px 18px rgba(0,0,0,.25)}
.section h2{font-size:20px;margin:0 0 10px}
.section h3{font-size:18px;margin:0 0 6px}
.section .qsub{color:var(--sub);font-size:14px;margin:0 0 12px}
.row{display:flex;flex-direction:column;gap:12px}
.field{display:flex;flex-direction:column;gap:8px}
label.cap{font-size:14px;color:var(--sub)}
select,input[type="text"]{width:100%;height:44px;border-radius:12px;border:1px solid var(--border);
  background:rgba(255,255,255,.02);color:var(--text);padding:0 12px;outline:none}
select:focus,input[type="text"]:focus{border-color:var(--accent2);box-shadow:0 0 0 3px rgba(34,211,238,.12)}
.choices{display:flex;flex-direction:column;gap:12px}
.choice{display:flex;align-items:center;gap:12px;padding:14px;border:1px solid var(--border);border-radius:14px;
  background:rgba(255,255,255,.02);transition:all .15s ease}
.choice:hover{border-color:var(--accent2);background:rgba(34,211,238,.06)}
.choice input[type="radio"]{appearance:none;width:20px;height:20px;border-radius:50%;border:2px solid var(--sub);position:relative;flex:0 0 auto;outline:none}
.choice input[type="radio"]:checked{border-color:var(--accent)}
.choice input[type="radio"]:checked::after{content:"";position:absolute;inset:3px;border-radius:50%;background:var(--accent)}
.choice .label{font-size:16px;line-height:1.4}
.btn{width:100%;height:50px;border:none;border-radius:14px;font-size:16px;font-weight:700;letter-spacing:.03em}
.btn.primary{background:var(--accent);color:#fff}
.btn.primary:active{transform:translateY(1px);opacity:.95}
#result .card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:18px;margin-top:18px}
#result .ttl{font-size:18px;margin:0 0 8px}
#result h4{font-size:16px;margin:14px 0 6px}
#result .lead{color:var(--sub)}
#result .dots{padding-left:18px;margin:8px 0}
#result .meta{color:var(--sub);font-size:12px;margin-top:10px}
#result .share{display:flex;gap:10px;margin-top:10px}
#result .btn.sub{flex:1;height:44px;background:rgba(255,255,255,.03);color:var(--text);border:1px solid var(--border);border-radius:12px}
.note{color:var(--sub);font-size:12px;margin:8px 2px 0}
</style>
</head>
<body>
  <div class="wrap">
    <h1>C Lab｜個性チェック</h1>
    <div id="status" class="status">読み込み中…</div>

    <!-- プロフィール -->
    <section class="section" id="profile">
      <h2>プロフィール</h2>
      <div class="row">
        <div class="field">
          <label class="cap">性別</label>
          <select id="gender" required>
            <option value="" selected>選んでね</option>
            <option value="male">男性</option>
            <option value="female">女性</option>
            <option value="other">その他</option>
          </select>
        </div>
        <div class="field">
          <label class="cap">年齢</label>
          <select id="age" required>
            <option value="" selected>選んでね</option>
            <!-- 12〜35 は下のJSで自動挿入 -->
          </select>
        </div>
        <div class="field">
          <label class="cap">MBTI（わかれば）</label>
          <select id="mbti">
            <option value="" selected>未回答</option>
            <option>INTJ</option><option>INTP</option><option>ENTJ</option><option>ENTP</option>
            <option>INFJ</option><option>INFP</option><option>ENFJ</option><option>ENFP</option>
            <option>ISTJ</option><option>ISFJ</option><option>ESTJ</option><option>ESFJ</option>
            <option>ISTP</option><option>ISFP</option><option>ESTP</option><option>ESFP</option>
          </select>
        </div>
      </div>
    </section>

    <!-- Q1 -->
    <section class="section">
      <h3>1. はじめるとき、近いのは？🏃‍♂️</h3>
      <div class="choices">
        <label class="choice">
          <input type="radio" name="q1" value="A">
          <span class="label">A. とりあえずやってみて、走りながら直す</span>
        </label>
        <label class="choice">
          <input type="radio" name="q1" value="B">
          <span class="label">B. まず全体をざっくり決めてから動く</span>
        </label>
      </div>
    </section>

    <!-- Q2 -->
    <section class="section">
      <h3>2. 迷ったら、何で決める？💭</h3>
      <div class="choices">
        <label class="choice">
          <input type="radio" name="q2" value="A">
          <span class="label">A. 直感・フィーリング</span>
        </label>
        <label class="choice">
          <input type="radio" name="q2" value="B">
          <span class="label">B. 理由やデータ</span>
        </label>
      </div>
    </section>

    <!-- Q3（モチベーション：プルダウン×3） -->
    <section class="section">
      <h3>3. 「よし、やるぞ！」のスイッチは？🔥（複数OK／できれば順位）</h3>
      <div class="row">
        <div class="field">
          <label class="cap">第1位</label>
          <select id="mot1"><option value="" selected>未選択</option></select>
        </div>
        <div class="field">
          <label class="cap">第2位（任意）</label>
          <select id="mot2"><option value="" selected>未選択</option></select>
        </div>
        <div class="field">
          <label class="cap">第3位（任意）</label>
          <select id="mot3"><option value="" selected>未選択</option></select>
        </div>
      </div>
      <p class="note">※ 同じ項目は重複できません。選ばないところは「未選択」のままでOK。</p>

      <!-- app.js が読む hidden チェックボックス（自動同期） -->
      <div id="q3-hidden" style="display:none"></div>
    </section>

    <!-- Q4 -->
    <section class="section">
      <h3>4. どっちの方がしんどい？😓</h3>
      <div class="choices">
        <label class="choice">
          <input type="radio" name="q4" value="A">
          <span class="label">A. ずっと細かく口出しされる</span>
        </label>
        <label class="choice">
          <input type="radio" name="q4" value="B">
          <span class="label">B. 丸投げで放置される</span>
        </label>
      </div>
    </section>

    <!-- Q5 -->
    <section class="section">
      <h3>5. 気持ちが動いたとき、近いのは？🫀</h3>
      <div class="choices">
        <label class="choice">
          <input type="radio" name="q5" value="A">
          <span class="label">A. 顔や言葉にすぐ出る</span>
        </label>
        <label class="choice">
          <input type="radio" name="q5" value="B">
          <span class="label">B. 表にはあまり出さない</span>
        </label>
      </div>
    </section>

    <!-- Q6 -->
    <section class="section">
      <h3>6. 一緒にいてラクなのは？😌</h3>
      <div class="choices">
        <label class="choice">
          <input type="radio" name="q6" value="A">
          <span class="label">A. なんでもズバッと言えるチーム</span>
        </label>
        <label class="choice">
          <input type="radio" name="q6" value="B">
          <span class="label">B. 空気を大事にするまったりチーム</span>
        </label>
      </div>
    </section>

    <!-- Q7 -->
    <section class="section">
      <h3>7. 自然と多い役割は？🤝</h3>
      <div class="choices">
        <label class="choice">
          <input type="radio" name="q7" value="A">
          <span class="label">A. みんなを引っ張るリーダー</span>
        </label>
        <label class="choice">
          <input type="radio" name="q7" value="B">
          <span class="label">B. サポートして支える</span>
        </label>
      </div>
    </section>

    <!-- Q8 -->
    <section class="section">
      <h3>8. 理想に近いのは？💫</h3>
      <div class="choices">
        <label class="choice">
          <input type="radio" name="q8" value="A">
          <span class="label">A. 一つのことをじっくり極める</span>
        </label>
        <label class="choice">
          <input type="radio" name="q8" value="B">
          <span class="label">B. いろんなことに同時に挑戦する</span>
        </label>
      </div>
    </section>

    <button id="run" class="btn primary">結果を見る</button>

    <div id="result"></div>
    <p class="note"></p>
  </div>

  <!-- モチベ（プルダウン）→ hidden checkbox へ同期（app.js互換） + 年齢自動生成 -->
  <script>
    (function(){
      // 年齢 12〜35 を自動挿入
      const ageSel = document.getElementById('age');
      for(let a=12;a<=35;a++){ const o=document.createElement('option'); o.value=a; o.textContent=a; ageSel.appendChild(o); }

      // モチベ13項目（表示テキスト）
      const MOTS = [
        ["達成","なにかを達成したとき（達成感）"],
        ["承認","認められたり褒められたとき（承認）"],
        ["貢献","誰かの役に立てたとき（貢献）"],
        ["安心","安心できる環境があるとき（安心）"],
        ["探究","新しいことを知れたとき（探究）"],
        ["自由","自分のやり方で自由にできるとき（自由）"],
        ["仲間","仲間と一緒に動けるとき（仲間）"],
        ["成長","成長している実感があるとき（成長）"],
        ["収入","ちゃんと稼げる・お金につながるとき（収入）"],
        ["役割","自分の担当・役割がハッキリしているとき（役割）"],
        ["変化","変化があってワクワクするとき（変化）"],
        ["競争","ライバルがいて燃えるとき（競争）"],
        ["使命","これは自分の使命だと感じるとき（使命）"]
      ];

      const selects = [document.getElementById('mot1'), document.getElementById('mot2'), document.getElementById('mot3')];
      const hiddenBoxWrap = document.getElementById('q3-hidden');

      // セレクトとhiddenチェックボックスを生成
      function buildOptions(){
        // hidden checkbox
        hiddenBoxWrap.innerHTML = "";
        MOTS.forEach(([val])=>{
          const cb = document.createElement('input');
          cb.type = 'checkbox'; cb.name='q3'; cb.value=val;
          hiddenBoxWrap.appendChild(cb);
        });
        // selects
        selects.forEach(sel=>{
          // 既存の未選択以外をクリア
          [...sel.options].forEach((op,i)=>{ if(i>0) sel.removeChild(op); });
          MOTS.forEach(([val, text])=>{
            const op = document.createElement('option');
            op.value = val; op.textContent = text;
            sel.appendChild(op);
          });
        });
      }

      function dedupeSelects(){
        const picked = new Set(selects.map(s=>s.value).filter(Boolean));
        selects.forEach(sel=>{
          Array.from(sel.options).forEach(op=>{
            if(!op.value) return;
            op.disabled = picked.has(op.value) && sel.value !== op.value;
          });
        });
      }
      function syncToHidden(){
        const hidden = hiddenBoxWrap.querySelectorAll('input[name="q3"]');
        hidden.forEach(cb=>{cb.checked=false;cb.dataset.order='';});
        const vals=selects.map(s=>s.value).filter(Boolean);
        let order=1;
        vals.forEach(v=>{
          const cb=[...hidden].find(c=>c.value===v);
          if(cb){cb.checked=true;cb.dataset.order=String(order++);}
        });
      }

      buildOptions();
      selects.forEach(sel=>sel.addEventListener('change',()=>{dedupeSelects();syncToHidden();}));
      dedupeSelects();syncToHidden();
    })();
  </script>

  <!-- LIFF SDK & App -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script src="/liff/app.js"></script>
</body>
</html>
